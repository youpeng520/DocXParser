# DocXParser

## 实现的功能
- 1.解压DOCX、解析XML、处理段落、表格、图片


## 还需要处理的功能
- 1.字体样式
- 2.列表处理
- 3.分页逻辑
续需解析水印元素并添加到 PDF 背景

// MARK: - 表格分页处理说明
// 当前实现暂不支持跨页表格拆分，长表格可能会被截断
// 后续需要实现表格行拆分和跨页续打功能


## 验证功能
段落和文本样式：字体、颜色、粗体、斜体、下划线
表格处理：表格的边框、合并单元格、列宽和行高是否正确计算和绘制。用户实现了自定义的表格绘制逻辑，但需要确认分页时表格是否正确拆分，以及边框样式是否正确应用。
图片处理：图片的尺寸是否正确转换，特别是在PDF中的绘制位置和缩放。用户代码中使用了EMU到点的转换，需要确认计算正确。
分页和布局：在生成PDF时，如何处理内容超出页面高度的情况，是否正确地分页。用户的`generatePDFWithCustomLayout`函数中的分页逻辑是否健壮，特别是对于长表格和图片的处理。
错误处理：现有的错误枚举是否覆盖了所有可能的异常情况，如文件损坏、不支持的样式等

段落处理中，用户处理了段落属性如对齐、缩进、间距，以及运行属性如字体样式。这里可能需要确认是否处理了所有可能的OOXML属性，比如行距的精确控制、首行缩进等。例如，在`parseParagraphProperties`中处理了`w:spacing`，但需要确认是否正确计算了行高倍数和固定行高。

表格处理是重点之一。用户的代码将表格转换为自定义的`TableDrawingData`结构，并在PDF中手动绘制。需要确认列宽的计算是否正确，特别是合并单元格的情况。在`processTable`函数中，用户处理了`w:gridCol`和合并单元格，但可能需要更精确的列宽计算，尤其是在没有网格定义时根据内容自动调整。

图片处理部分，用户从关系文件中获取图片路径，并加载图片，使用EMU转换为点。需要确认EMU转换是否正确，1英寸=914400 EMU，1点=1/72英寸，所以EMU到点的转换应该是除以914400*72？或者用户代码中的`emuPerPoint`是否正确？用户代码中定义为12700，这可能不正确，需要检查。正确的转换应该是1点=12700 EMU（来自OOXML规范），所以用户是正确的。

分页逻辑方面，用户的`generatePDFWithCustomLayout`函数中，当内容超出页面时，会创建新页面。但对于长表格，可能需要将表格拆分成多页，目前的实现可能无法处理，特别是跨页的行的拆分。用户代码中处理了垂直合并，但分页时可能只简单换页，导致表格被截断。这可能需要更复杂的分页处理，比如将表格分成多个部分绘制在不同页面上，但实现起来较复杂，用户可能暂时没有处理，需要添加注释说明当前限制。


错误处理方面，现有的`DocParserError`枚举涵盖了主要错误情况，但可能需要添加更多细节，比如样式解析失败、不支持的边框类型等。


实现styles.xml解析以支持样式继承
添加numbering.xml解析实现完整列表格式
支持跨页表格拆分
实现PDF交互元素（可点击链接）
支持文档分节的不同页面设置
添加水印和页眉页脚支持
